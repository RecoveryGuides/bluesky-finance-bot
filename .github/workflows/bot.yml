name: ğŸš€ Finance Growth Bot

on:
  schedule:
    - cron: '0 14 * * *'  # 9 AM EST
    - cron: '0 18 * * *'  # 1 PM EST  
    - cron: '0 22 * * *'  # 5 PM EST
  workflow_dispatch:

jobs:
  run-bot:
    runs-on: ubuntu-latest
    timeout-minutes: 15  # ZwiÄ™kszony timeout
    
    steps:
    - name: ğŸ“¥ Pobierz kod
      uses: actions/checkout@v4
    
    - name: ğŸ Ustaw Pythona
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
    
    - name: ğŸ“¦ Zainstaluj atproto
      run: pip install atproto==0.0.48
    
    - name: ğŸ¤– Uruchom bota z auto-setup
      env:
        BLUESKY_HANDLE: ${{ secrets.BLUESKY_HANDLE }}
        BLUESKY_PASSWORD: ${{ secrets.BLUESKY_PASSWORD }}
      run: |
        echo "========================================"
        echo "ğŸš€ URUCHAMIANIE BOTA Z AUTO-SETUP"
        echo "========================================"
        python finance_growth_bot.py
    
    - name: ğŸ“Š Zapisz wyniki
      if: always()
      uses: actions/upload-artifact@v4
      with:
        name: bot-results
        path: |
          bot_stats.json
          comments_history.json
        retention-days: 7
    
    - name: ğŸ“ˆ Podsumowanie
      if: always()
      run: |
        echo ""
        echo "========================================"
        echo "ğŸ“Š PODSUMOWANIE"
        echo "========================================"
        
        if [ -f "bot_stats.json" ]; then
          echo "ğŸ“ˆ STATYSTYKI:"
          COMMENTS=$(grep -o '"total_comments":[0-9]*' bot_stats.json | grep -o '[0-9]*' || echo "0")
          LINKS=$(grep -o '"shop_links":[0-9]*' bot_stats.json | grep -o '[0-9]*' || echo "0")
          FOLLOWS=$(grep -o '"follows_done":[0-9]*' bot_stats.json | grep -o '[0-9]*' || echo "0")
          LIKES=$(grep -o '"likes_done":[0-9]*' bot_stats.json | grep -o '[0-9]*' || echo "0")
          
          echo "ğŸ’¬ Komentarzy: $COMMENTS"
          echo "ğŸ”— LinkÃ³w do sklepu: $LINKS"
          echo "ğŸ‘¥ Obserwowanych kont: $FOLLOWS"
          echo "â¤ï¸  Polubionych postÃ³w: $LIKES"
        else
          echo "âŒ Brak statystyk"
        fi
        
        if [ -f "comments_history.json" ]; then
          SIZE=$(wc -c < comments_history.json)
          echo "ğŸ“ Historia komentarzy: $SIZE bajtÃ³w"
        fi
        
        echo ""
        echo "========================================"
        echo "ğŸ“¥ DO POBRANIA: bot-results"
        echo "ğŸ”„ NASTÄ˜PNY RAZ ZA:"
        echo "   - 9 AM EST (14:00 UTC)"
        echo "   - 1 PM EST (18:00 UTC)"
        echo "   - 5 PM EST (22:00 UTC)"
        echo "ğŸ”— SKLEP: https://www.payhip.com/daveprime"
        echo "========================================"
